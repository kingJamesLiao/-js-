<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>shoppingCart</title>
    <!-- <link rel="stylesheet" href="../css/jiesuan.css"> -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/headfooter.css">
    <link rel="stylesheet" href="../css/commoLeft.css">
    <link rel="stylesheet" href="../css/list3.css">
</head>

<body>
    <!-- 头部导航条 -->
    <nav class="navbar navbar-default">
        <div class="container">
            <!-- logo和折叠按钮 -->
            <div class="navbar-header">
                <div class="slogan">
                    联系我们
                </div>
            </div>

            <div class="navbar-right">
                <!-- 折叠按钮 -->
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- 缩小之后会被折叠的元素 -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul style="color: #fff;">
                        <li>
                            <a href="shoppCart.html">购物车</a>
                        </li>
                        <li>
                            <a href="./src/register.html">订单</a>|
                        </li>
                        <li>
                            <a href="" data-toggle="modal" data-target="#myModal">XMM888</a>|
                        </li>
                    </ul>
                </div>


            </div>
            <div class="container-fluid">
                <div class="head listHead col-lg-10  col-md-10  col-sm-10 ">
                    <h1>XMM</h1>
                    <div class="head-input">
                        <span class="cur">站内</span>
                        <span>站外</span>
                        <input type="text" placeholder="请输入内容">
                        <a href=""><img src="./images/sousuo.png" alt=""></a>
                    </div>
                </div>
                <div class="store listStore">
                    <a href="shoppCart.html">
                        <img src="../images/store.png" alt="">
                    </a>
                </div>
            </div>

        </div>
    </nav>

    <!-- 模态框 -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">标题</h4>
                </div>
                <div class="modal-body">
                    内容
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭按钮</button>
                    <button type="button" class="btn btn-primary">确定</button>
                </div>
            </div>
        </div>
    </div>
    <section>
        <div class="lists">
            <div class="listLeft">
                <p>列表</p>
                <span></span>
                <ul>
                    <li class="first">
                        <div class="photo">
                            <img src="../images/touxiang.jpg" alt="">
                        </div>
                        <div class="username">
                            您好 , 巅峰召唤师
                        </div>
                        <div class="type">
                            <div>
                                <h4>2</h4>
                                <p>待付款</p>
                            </div>
                            <div>
                                <h4>0</h4>
                                <p>处理中</p>
                            </div>
                            <div>
                                <h4>0</h4>
                                <p>待收货</p>
                            </div>
                            <div>
                                <h4>0</h4>
                                <p>待评价</p>
                            </div>
                        </div>
                        <div class="screen">
                            <marquee scrollamount="5">
                                <div class="marquee">圣诞节快乐! 圣诞节快乐! 圣诞节快乐! </div>
                            </marquee>
                        </div>
                    </li>
                    <li><a href="list.html">个人信息</a></li>
                    <li class="ref"><a style=" color: #F38420;" href="shoppCart.html">购物车</a></li>
                    <li><a href="order.html">订购清单</a></li>
                    <li><a href="notPaid.html">待付款</a></li>
                    <li><a href="inHend.html">处理中</a></li>
                    <li><a href="loading.html">查看商品实图</a></li>
                    <li class="indeterminate"><a href="notPaidTwo.html">二次付款通知</a></li>
                    <li><a href="inTransit.html">产品运输中</a></li>
                    <li><a href="ofGoods.html">待收货</a></li>
                    <li><a href="over.html">完成订单</a></li>
                    <li><a href="off.html">取消订单</a></li>
                </ul>
            </div>
            <div class="listRight cart">
                <div class="cartHeader">
                    <div class="strip cur"><a>1</a>购物车结算</div>
                    <div class="strip"><a>2</a>订单确认</div>
                    <div class="strip"><a>3</a>等待审核</div>
                </div>
                <div class="cartCenter">
                    <div class="main">
                        <div class="main-top">
                            <div class="top-left">
                                <input type="checkbox" class="all">
                                <p>选择</p>
                                <p>商品信息</p>
                            </div>
                            <div class="top-right">
                                <ul>
                                    <li>单价</li>
                                    <li>数量</li>
                                    <li>总价</li>
                                    <li>删除</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div id="store" class="store">
                            <div class="store-top">
                                <input type="checkbox" class="one">
                                <p>欧塞洛斯照明旗舰店</p>
                                <img src="../images/ali.png" alt="">
                            </div>
                            <div class="store-bottom">
                                <div class="s-b-left">
                                    <input type="checkbox" class="two">
                                    <img src="../images/yht-logo-195X80.png" alt="">
                                    <div class="tle">
                                        <p>
                                            欧塞洛斯 欧式全铜吊灯客厅卧室餐厅灯具灯饰
                                        </p>
                                        <p>
                                            颜色:6头
                                        </p>
                                    </div>
                                </div>
                                <div class="s-b-right">
                                    <div class="box1">
                                        <span>￥</span>
                                        <span class="yuanjia">459.00</span>
                                    </div>
                                    <div class="box2">
                                        <ul class="list">
                                            <li class="jian">-</li>
                                            <li class="num">1</li>
                                            <li class="jia">+</li>
                                        </ul>
                                    </div>
                                    <div class="box3">
                                        <span>￥</span>
                                        <span class="money">459.00</span>
                                    </div>
                                    <div class="box4">
                                        <img src="../images/del.png" alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="store" class="store">
                            <div class="store-top">
                                <input type="checkbox" class="one">
                                <p>欧塞洛斯照明旗舰店</p>
                                <img src="../images/ali.png" alt="">
                            </div>
                            <div class="store-bottom">
                                <div class="s-b-left">
                                    <input type="checkbox" class="two">
                                    <img src="../images/yht-logo-195X80.png" alt="">
                                    <div class="tle">
                                        <p>
                                            欧塞洛斯 欧式全铜吊灯客厅卧室餐厅灯具灯饰
                                        </p>
                                        <p>
                                            颜色:6头
                                        </p>
                                    </div>
                                </div>
                                <div class="s-b-right">
                                    <div class="box1">
                                        <span>￥</span>
                                        <span class="yuanjia">459.00</span>
                                    </div>
                                    <div class="box2">
                                        <ul class="list">
                                            <li class="jian">-</li>
                                            <li class="num">1</li>
                                            <li class="jia">+</li>
                                        </ul>
                                    </div>
                                    <div class="box3">
                                        <span>￥</span>
                                        <span class="money">459.00</span>
                                    </div>
                                    <div class="box4">
                                        <img src="../images/del.png" alt="">
                                    </div>
                                </div>
                            </div>
                            <div class="store-bottom">
                                <div class="s-b-left">
                                    <input type="checkbox" class="two">
                                    <img src="../images/yht-logo-195X80.png" alt="">
                                    <div class="tle">
                                        <p>
                                            欧塞洛斯 欧式全铜吊灯客厅卧室餐厅灯具灯饰
                                        </p>
                                        <p>
                                            颜色:6头
                                        </p>
                                    </div>
                                </div>
                                <div class="s-b-right">
                                    <div class="box1">
                                        <span>￥</span>
                                        <span class="yuanjia">859.00</span>
                                    </div>
                                    <div class="box2">
                                        <ul class="list">
                                            <li class="jian">-</li>
                                            <li class="num">1</li>
                                            <li class="jia">+</li>
                                        </ul>
                                    </div>
                                    <div class="box3">
                                        <span>￥</span>
                                        <span class="money">859.00</span>
                                    </div>
                                    <div class="box4">
                                        <img src="../images/del.png" alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="footer3">
                            <div class="footer-left">
                                <input type="checkbox" class="all">
                                <ul>
                                    <li>全选&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;已选SKU:<span>0</span></li>
                                    <li style="fontSize:8px">注:1.物品最多累计1000 &nbsp;订单列表不可多于50个SKU</li>
                                </ul>
                            </div>
                            <div class="footer-right">
                                <!-- <p>已选择<span>1</span>件商品<span>∧</span>
                                    </p> -->
                                <div>
                                    <p>总价:
                                        <span>￥</span>
                                        <span id="total">0.00</span>
                                    </p>
                                    <img src="images/jingdomg_06.png" alt="">
                                    <br>
                                    <!-- <p>已节省：<span>￥</span>0.00</p> -->
                                </div>
                            </div>
                            <a href="./order.html">去结算</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer>
        <div class="footer footer2">
            <ul>
                <li><a>服务协议</a></li>
                <li><a>服务协议</a></li>
                <li><a>服务协议</a></li>
                <li><a>服务协议</a></li>
                <li><a>服务协议</a></li>
            </ul>
        </div>
    </footer>
    <script src="../js/jquery-1.12.3.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script>
        function G(name) {
            return document.getElementsByClassName(name)
        }

        function J(tagName) {
            return document.getElementsByTagName(tagName)
        }

        function N(id) {
            return document.getElementById(id)
        }

        function K() {
            for (var n = 0; n < G("store-bottom").length; n++) {
                G("store-bottom")[n].style.backgroundColor = "#fff4e8";
            }
        }

        function H() {
            for (var n = 0; n < G("store-bottom").length; n++) {
                G("store-bottom")[n].style.backgroundColor = "white";
            }
        }
        //触发全选
        function Q(state) {
            for (var i = 0; i < G("all").length; i++) {
                G("all")[i].checked = state;
            }
        }
        //求和
        function M() {
            var total = 0;
            for (var j = 0; j < G("money").length; j++) {

                total += parseFloat(G("money")[j].innerHTML);

            }
            N('total').innerHTML = toDecimal2(total);
        }
        //验证店铺选中状态
        function store(){
            var storeLength = G("one").length;
            var sum=0;
            for (var i = 0; i < storeLength; i++) {
                if(G('one')[i].checked === true){
                    sum += 1;
                    if(sum === storeLength){
                        Q(true);
                    }
                }
            }
        }
        // store()
        //验证商品选中状态
        function pitch() {
            var checkLength = G("two").length;
            var xiaoji = 0;
            var count = 0;
            for (var i = 0; i < checkLength; i++) {
                if (G("two")[i].checked === true) {

                    G("two")[i].style.backgroundColor = "#fff4e8";
                    xiaoji += parseFloat(G("money")[i].innerHTML);
                    count += parseInt(G("num")[i].innerHTML);

                }
            }
            N('total').innerHTML = toDecimal2(xiaoji)
            $('.footer-left ul li span').html(count)
        }
        //强制保留两位小数
        function toDecimal2(x) {
            var f = parseFloat(x);
            if (isNaN(f)) {
                return false;
            }
            var f = Math.round(x * 100) / 100;
            var s = f.toString();
            var rs = s.indexOf('.');
            if (rs < 0) {
                rs = s.length;
                s += '.';
            }
            while (s.length <= rs + 2) {
                s += '0';
            }
            return s;
        }
        for (var i = 0; i < J("input").length; i++) {
            J("input")[i].checked = false;
        }
        for (var i = 0; i < G("list").length; i++) {
            G("jia")[i].index = i;
            G("jian")[i].index = i;
            G("list")[i].onclick = function (event) {
                var tar = event.target;
                var ind = tar.index;
                // console.log(tar)
                var num = G("num")[ind].innerHTML;
                // console.log(num)
                var yuanjia = G("yuanjia")[ind].innerHTML;
                var storeBot;
                if (tar.getAttribute("class") == "jia") {
                    num++;
                    storeBot = $(this).parent("div").parent("div").parent(".store-bottom")[0];
                    storeBot.style.background = '#fff4e8';

                } else if (tar.getAttribute("class") == "jian") {
                    if (num > 1) {
                        num--;
                    } else {
                        num = 1;
                    }
                }
                G("num")[ind].innerHTML = num;
                var money = parseFloat(yuanjia) * num;
                G("money")[ind].innerHTML = toDecimal2(parseFloat(money));
                // G("one")[ind].checked = true;
                G("two")[ind].checked = true;
                pitch()

            }
        }
        for (var i = 0; i < G("all").length; i++) {
            G("all")[i].onclick = function () {
                var input = J("input");
                if (this.checked) {
                    for (var j = 0; j < input.length; j++) {
                        input[j].checked = true;
                    }
                    K();
                    M();
                } else {
                    for (var m = 0; m < input.length; m++) {
                        input[m].checked = false;
                    }
                    H();
                    N('total').innerHTML = toDecimal2(0);
                }
            }
        }
        
        var arr = [];
        for (var i = 0; i < G("one").length; i++) {
            G("one")[i].onclick = function () {
               
                var ind = this.index;
                var money = $(this).parent(".store-top").parent(".store").find(".money");
                var two = $(this).parent(".store-top").parent(".store").find(".two");
                var storeBottom = $(this).parent(".store-top").parent(".store").find(".store-bottom");
                var oneSib = $(this).parent(".store-top").parent(".store").siblings(".store").find(
                    ".one"); //店铺名兄弟元素
                var moneyLength = $(this).parent(".store-top").parent(".store").find(".money").length;
                for (var i = 0; i < oneSib.length; i++) {
                    if (oneSib[i].checked != false) {
                        Q(true);
                    }
                }
                var xiaoji = 0;
                for (var k = 0; k < moneyLength; k++) {
                    xiaoji += parseFloat($(this).parent(".store-top").parent(".store").find(".money")[k].innerHTML);
                }
                if (this.checked == false) {
                    Q(false);
                    for (var k = 0; k < moneyLength; k++) {
                        two[k].checked = false;
                        storeBottom[k].style.backgroundColor = "white";
                    }
                    arr.pop(xiaoji)
                    var n = 0;
                    for (var m in arr) {
                        n += arr[m];
                    }
                    N('total').innerHTML = toDecimal2(n)
                } else {
                    arr.push(xiaoji)
                    for (var k = 0; k < moneyLength; k++) {
                        two[k].checked = true;
                        storeBottom[k].style.backgroundColor = "#fff4e8";
                    }
                    var n = 0;
                    for (var m in arr) {
                        n += arr[m];
                    }
                    N('total').innerHTML = toDecimal2(n)
                }
                pitch();
            }
        }
        //二级按钮
        for (var i = 0; i < G("two").length; i++) {

            G("two")[i].index = i;
            G("two")[i].onclick = function () {
                pitch();
                var ind = this.index;
                var parentOne = $(this).parent(".s-b-left").parent(".store-bottom").parent(".store").find(".one")[
                    0];
                // var parentOneSib = $(this).parent(".s-b-left").parent(".store-bottom").parent(".store").siblings('.store').find(".one");
                var checkSib = $(this).parent(".s-b-left").parent(".store-bottom").siblings(".store-bottom");
            //    console.log(parentOneSib.)
                if (this.checked == true && checkSib.length < 1) {
                    $(this).parent(".s-b-left").parent(".store-bottom")[0].style.backgroundColor = "#fff4e8";
                    parentOne.checked = true;
                    store()
                //     for (var i = 0; i < parentOne.length; i++) {
                //         console.log(i)
                //     if (parentOne[i].checked != false) {
                //         Q(true);
                //     }
                // }
                } else if (this.checked == true && checkSib.length > 0) {
                    $(this).parent(".s-b-left").parent(".store-bottom")[0].style.backgroundColor = "#fff4e8";
                    for (var i = 0; i < checkSib.length; i++) {
                        if (checkSib.find(".two")[i].checked != false) {
                            parentOne.checked = true;
  
                            store()
                        }
                    }
                } else {
                    $(this).parent(".s-b-left").parent(".store-bottom")[0].style.backgroundColor = "white";
                    parentOne.checked = false;
                    Q(false);

                }
            }
        }
        // }
    </script>
</body>

</html>